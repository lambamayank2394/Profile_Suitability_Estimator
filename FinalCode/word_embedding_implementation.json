{"paragraphs":[{"text":"%md\n## Programming in Big Data\n# Profile Suitability Estimator (Final Code)\n","user":"anonymous","dateUpdated":"2018-12-21T23:00:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Programming in Big Data</h2>\n<h1>Profile Suitability Estimator (Final Code)</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1545433143249_2107691252","id":"20181221-225903_114236955","dateCreated":"2018-12-21T22:59:03+0000","dateStarted":"2018-12-21T23:00:22+0000","dateFinished":"2018-12-21T23:00:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:29890"},{"text":"%md\nIn this notebook, we'll be going through the process of loading the Resume and Job Description data, creating word embbedings out of them and applying cosine similarity in order to get the Top 10 resumes for each of the Job Descriptions. The code is written for a <b>pyspark</b> interpreter. And therefore it is implementable at scale.","user":"anonymous","dateUpdated":"2018-12-21T23:07:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In this notebook, we&rsquo;ll be going through the process of loading the Resume and Job Description data, creating word embbedings out of them and applying cosine similarity in order to get the Top 10 resumes for each of the Job Descriptions. The code is written for a <b>pyspark</b> interpreter. And therefore it is implementable at scale.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545433243508_-1739474297","id":"20181221-230043_2075631737","dateCreated":"2018-12-21T23:00:43+0000","dateStarted":"2018-12-21T23:07:36+0000","dateFinished":"2018-12-21T23:07:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29891"},{"text":"%sh\n# if pandas is not already installed run the following:\n# pip install pandas","user":"anonymous","dateUpdated":"2018-12-21T23:03:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545433379868_2013457070","id":"20181221-230259_2127477447","dateCreated":"2018-12-21T23:02:59+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:29892"},{"text":"%pyspark\n# Lets clear the cache \nspark.catalog.clearCache()\n","user":"anonymous","dateUpdated":"2018-12-22T00:23:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545210516757_-1051712165","id":"20181219-090836_493755522","dateCreated":"2018-12-19T09:08:36+0000","dateStarted":"2018-12-22T00:23:11+0000","dateFinished":"2018-12-22T00:23:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29893"},{"text":"%pyspark\nimport pyspark.sql.functions as f\nfrom pyspark.sql.types import StringType, IntegerType, ArrayType, FloatType","user":"anonymous","dateUpdated":"2018-12-22T00:23:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545091954049_-1942562492","id":"20181218-001234_1353384549","dateCreated":"2018-12-18T00:12:34+0000","dateStarted":"2018-12-22T00:23:15+0000","dateFinished":"2018-12-22T00:23:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29894"},{"text":"%pyspark\nimport pandas as pd\nimport numpy as np\n# import scipy as sp","user":"anonymous","dateUpdated":"2018-12-22T00:23:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545102127698_810394374","id":"20181218-030207_1923718608","dateCreated":"2018-12-18T03:02:07+0000","dateStarted":"2018-12-22T00:23:56+0000","dateFinished":"2018-12-22T00:23:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29895"},{"text":"%pyspark\n# Let us first load the resume data\ndata_res = sqlContext.read.load('/zeppelin/data/resume_dataset.csv', format='com.databricks.spark.csv', header='true', inferSchema='true')\ndata_res.show()","user":"anonymous","dateUpdated":"2018-12-22T00:23:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+--------------------+\n| ID|Category|              Resume|\n+---+--------+--------------------+\n|  1|      HR|b'John H. Smith, ...|\n|  2|      HR|b'Name SurnamenAd...|\n|  3|      HR|b'Anthony BrownnH...|\n|  4|      HR|b'www.downloadmel...|\n|  5|      HR|\"b\"\"HUMAN RESOURC...|\n|  6|      HR|b'John H. Smith, ...|\n|  7|      HR|b'Resume of Sathe...|\n|  8|      HR|\"b\"\"GM HR & ADMIN...|\n|  9|      HR|\"b\"\"www.uaehrzone...|\n| 10|      HR|\"b\"\"Human Resourc...|\n| 11|      HR|b'RESUME WORLD IN...|\n| 12|      HR|b'XXXXX XXXXXnXXX...|\n| 13|      HR|b'SATHEESHnnwww.d...|\n| 14|      HR|b'Alan Bloggs BEn...|\n| 15|      HR|b'www.downloadmel...|\n| 16|      HR|b'Anthony BrownnH...|\n| 17|      HR|b'TnnAYLOR J ONES...|\n| 18|      HR|b'Human Resources...|\n| 19|      HR|b'EDMONDxc2xa0BRA...|\n| 20|      HR|b'Jonathan Burnsn...|\n+---+--------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1544743557560_-1758571766","id":"20181213-232557_1441054158","dateCreated":"2018-12-13T23:25:57+0000","dateStarted":"2018-12-22T00:23:56+0000","dateFinished":"2018-12-22T00:24:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29896"},{"text":"%md\nWe can see some unnecessary strings in the begining of every resume text. Let us first get rid of that.","user":"anonymous","dateUpdated":"2018-12-21T23:09:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>We can see some unnecessary strings in the begining of every resume text. Let us first get rid of that.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545433729044_1311797669","id":"20181221-230849_2036146288","dateCreated":"2018-12-21T23:08:49+0000","dateStarted":"2018-12-21T23:09:35+0000","dateFinished":"2018-12-21T23:09:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29897"},{"text":"%pyspark\n# let us first investigate what different kinds of strings that we need to get rid of\nnew = f.udf(lambda x:x[:2])\ndata_res.withColumn('new', new(data_res['Resume'])).select('new').distinct().show()\n# data2 = sc.wholeTextFiles('/zeppelin/data/all_resumes/*.txt').toDF()\n# data2.show()","user":"anonymous","dateUpdated":"2018-12-22T00:23:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+\n|new|\n+---+\n| b\"|\n| b'|\n| \"b|\n+---+\n\n"}]},"apps":[],"jobName":"paragraph_1545084571011_-1485945908","id":"20181217-220931_1708842430","dateCreated":"2018-12-17T22:09:31+0000","dateStarted":"2018-12-22T00:23:58+0000","dateFinished":"2018-12-22T00:24:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29898"},{"text":"%pyspark\n# Lets rid our data of unnecessary escape characters and the also the ones mentioned above\ncleaner = f.udf(lambda x:x.replace('\\\\n', ' ').replace('\\\\r', ' ').replace('\\\\t', ' ').replace('\\\\x', ' ').replace(\"b'\", '').replace('b\"', '').replace('\"b', ''))\ndata_res = data_res.withColumn('Resume',cleaner(data_res['Resume']))\ndata_res.show()","user":"anonymous","dateUpdated":"2018-12-22T00:23:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+--------------------+\n| ID|Category|              Resume|\n+---+--------+--------------------+\n|  1|      HR|John H. Smith, P....|\n|  2|      HR|Name SurnamenAddr...|\n|  3|      HR|Anthony BrownnHR ...|\n|  4|      HR|www.downloadmela....|\n|  5|      HR|\"\"HUMAN RESOURCES...|\n|  6|      HR|John H. Smith, P....|\n|  7|      HR|Resume of Sathees...|\n|  8|      HR|\"\"GM HR & ADMINIS...|\n|  9|      HR|\"\"www.uaehrzone.c...|\n| 10|      HR|\"\"Human Resources...|\n| 11|      HR|RESUME WORLD INC....|\n| 12|      HR|XXXXX XXXXXnXXXX,...|\n| 13|      HR|SATHEESHnnwww.dow...|\n| 14|      HR|Alan Bloggs BEn1M...|\n| 15|      HR|www.downloadmela....|\n| 16|      HR|Anthony BrownnHR ...|\n| 17|      HR|TnnAYLOR J ONESn1...|\n| 18|      HR|Human Resources M...|\n| 19|      HR|EDMONDxc2xa0BRADY...|\n| 20|      HR|Jonathan Burnsn14...|\n+---+--------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545249185669_-446030524","id":"20181219-195305_1897858182","dateCreated":"2018-12-19T19:53:05+0000","dateStarted":"2018-12-22T00:24:07+0000","dateFinished":"2018-12-22T00:24:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29899"},{"text":"%pyspark\n# lets discretize the categories with a little spark code\ncategories = data_res.select('Category').distinct().alias('distinct_categories')\ncategory_map =  categories.rdd.zipWithIndex().toDF(schema=['Categories', 'cat_label'])\nstring_converter = f.udf(lambda x:\"\".join(x))\ncategory_map = category_map.withColumn('Categories', string_converter(category_map['Categories']))\ncategory_map.show(25)","user":"anonymous","dateUpdated":"2018-12-22T00:23:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---------+\n|          Categories|cat_label|\n+--------------------+---------+\n|            Advocate|        0|\n|           Education|        1|\n|               Sales|        2|\n|         Engineering|        3|\n|                 BPO|        4|\n|                  HR|        5|\n|Business Development|        6|\n|Information Techn...|        7|\n|          Consultant|        8|\n|           Managment|        9|\n|             Finance|       10|\n|            Aviation|       11|\n|        Agricultural|       12|\n|             Apparel|       13|\n|    Public Relations|       14|\n|       Digital Media|       15|\n|    Health & Fitness|       16|\n|    Food & Beverages|       17|\n|                Arts|       18|\n|Building & Constr...|       19|\n|          Architects|       20|\n|          Accountant|       21|\n|             Banking|       22|\n|          Automobile|       23|\n|           Designing|       24|\n+--------------------+---------+\n\n"}]},"apps":[],"jobName":"paragraph_1545085036221_-738705536","id":"20181217-221716_999142746","dateCreated":"2018-12-17T22:17:16+0000","dateStarted":"2018-12-22T00:24:12+0000","dateFinished":"2018-12-22T00:24:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29900"},{"text":"%pyspark\n# adding the new category labels to our data\ndata_res = data_res.join(category_map, data_res.Category == category_map.Categories).drop('Categories').orderBy('ID')\n\n# converting the resume text into lowercase\ndata_res = data_res.withColumn('lower', f.lower(data_res['Resume']))\ndata_res.cache()\ndata_res.show()","user":"anonymous","dateUpdated":"2018-12-22T00:23:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+--------------------+---------+--------------------+\n| ID|Category|              Resume|cat_label|               lower|\n+---+--------+--------------------+---------+--------------------+\n|  1|      HR|John H. Smith, P....|        5|john h. smith, p....|\n|  2|      HR|Name SurnamenAddr...|        5|name surnamenaddr...|\n|  3|      HR|Anthony BrownnHR ...|        5|anthony brownnhr ...|\n|  4|      HR|www.downloadmela....|        5|www.downloadmela....|\n|  5|      HR|\"\"HUMAN RESOURCES...|        5|\"\"human resources...|\n|  6|      HR|John H. Smith, P....|        5|john h. smith, p....|\n|  7|      HR|Resume of Sathees...|        5|resume of sathees...|\n|  8|      HR|\"\"GM HR & ADMINIS...|        5|\"\"gm hr & adminis...|\n|  9|      HR|\"\"www.uaehrzone.c...|        5|\"\"www.uaehrzone.c...|\n| 10|      HR|\"\"Human Resources...|        5|\"\"human resources...|\n| 11|      HR|RESUME WORLD INC....|        5|resume world inc....|\n| 12|      HR|XXXXX XXXXXnXXXX,...|        5|xxxxx xxxxxnxxxx,...|\n| 13|      HR|SATHEESHnnwww.dow...|        5|satheeshnnwww.dow...|\n| 14|      HR|Alan Bloggs BEn1M...|        5|alan bloggs ben1m...|\n| 15|      HR|www.downloadmela....|        5|www.downloadmela....|\n| 16|      HR|Anthony BrownnHR ...|        5|anthony brownnhr ...|\n| 17|      HR|TnnAYLOR J ONESn1...|        5|tnnaylor j onesn1...|\n| 18|      HR|Human Resources M...|        5|human resources m...|\n| 19|      HR|EDMONDxc2xa0BRADY...|        5|edmondxc2xa0brady...|\n| 20|      HR|Jonathan Burnsn14...|        5|jonathan burnsn14...|\n+---+--------+--------------------+---------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545090188101_-1166035755","id":"20181217-234308_1908508347","dateCreated":"2018-12-17T23:43:08+0000","dateStarted":"2018-12-22T00:24:12+0000","dateFinished":"2018-12-22T00:25:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29901"},{"text":"%md\nNow that we have cleaned our data to a certain extent, lets further clean and transform it with the help of <b>Pipeline</b> model from the <b>pyspark.ml</b> library. ","user":"anonymous","dateUpdated":"2018-12-21T23:16:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Now that we have cleaned our data to a certain extent, lets further clean and transform it with the help of <b>Pipeline</b> model from the <b>pyspark.ml</b> library.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545434078249_-2021440227","id":"20181221-231438_519720821","dateCreated":"2018-12-21T23:14:38+0000","dateStarted":"2018-12-21T23:16:31+0000","dateFinished":"2018-12-21T23:16:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29902"},{"text":"%pyspark\nfrom pyspark.ml import Pipeline \nfrom pyspark.ml.feature import * \n\n# a tokenizer splits the resume text into words\ntok = Tokenizer(inputCol=\"lower\", outputCol=\"words\")\n\n# stop words remover removes those words of the english language that are completely irrelevant to the analysis\nstop = StopWordsRemover(inputCol=\"words\", outputCol=\"stop_removed\")\n\n# encoder = OneHotEncoder(inputCol=\"cat_label\", outputCol=\"ohe\")\n\n# this model will create the actual word embeddings\nw2v = Word2Vec(inputCol=\"stop_removed\", outputCol=\"w2v\", vectorSize=300, seed=5)\n# assembler = VectorAssembler(inputCols=['ohe', 'w2v'], outputCol=\"merged_vectors\")\n\n# pipeline_1 = Pipeline(stages=[tok, stop, encoder, w2v, assembler])\n\n# We stage all of this together with a Pipeline model\npipeline_1 = Pipeline(stages=[tok, stop, w2v])\n\n# fitting to the data\nmodel_1 = pipeline_1.fit(data_res)","user":"anonymous","dateUpdated":"2018-12-22T00:23:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1544865525957_-752555785","id":"20181215-091845_1338054981","dateCreated":"2018-12-15T09:18:45+0000","dateStarted":"2018-12-22T00:24:34+0000","dateFinished":"2018-12-22T00:25:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29903"},{"text":"%pyspark\n# apply the model to the data and transform it\nresume_w2v = model_1.transform(data_res)\nresume_w2v = resume_w2v.drop('Resume')\nresume_w2v.show()","user":"anonymous","dateUpdated":"2018-12-22T00:23:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+---------+--------------------+--------------------+--------------------+--------------------+\n| ID|Category|cat_label|               lower|               words|        stop_removed|                 w2v|\n+---+--------+---------+--------------------+--------------------+--------------------+--------------------+\n|  1|      HR|        5|john h. smith, p....|[john, h., smith,...|[john, h., smith,...|[-0.0021475318403...|\n|  2|      HR|        5|name surnamenaddr...|[name, surnamenad...|[name, surnamenad...|[0.00186557567443...|\n|  3|      HR|        5|anthony brownnhr ...|[anthony, brownnh...|[anthony, brownnh...|[0.01010263937173...|\n|  4|      HR|        5|www.downloadmela....|[www.downloadmela...|[www.downloadmela...|[-0.0041754910170...|\n|  5|      HR|        5|\"\"human resources...|[\"\"human, resourc...|[\"\"human, resourc...|[-0.0597327542205...|\n|  6|      HR|        5|john h. smith, p....|[john, h., smith,...|[john, h., smith,...|[-0.0021475318403...|\n|  7|      HR|        5|resume of sathees...|[resume, of, sath...|[resume, satheesh...|[-0.0016074833797...|\n|  8|      HR|        5|\"\"gm hr & adminis...|[\"\"gm, hr, &, adm...|[\"\"gm, hr, &, adm...|[0.02007885929197...|\n|  9|      HR|        5|\"\"www.uaehrzone.c...|[\"\"www.uaehrzone....|[\"\"www.uaehrzone....|[0.01254018800013...|\n| 10|      HR|        5|\"\"human resources...|[\"\"human, resourc...|[\"\"human, resourc...|[0.01232772212409...|\n| 11|      HR|        5|resume world inc....|[resume, world, i...|[resume, world, i...|[-0.0064233342147...|\n| 12|      HR|        5|xxxxx xxxxxnxxxx,...|[xxxxx, xxxxxnxxx...|[xxxxx, xxxxxnxxx...|[-0.0060386060407...|\n| 13|      HR|        5|satheeshnnwww.dow...|[satheeshnnwww.do...|[satheeshnnwww.do...|[-0.0070745991333...|\n| 14|      HR|        5|alan bloggs ben1m...|[alan, bloggs, be...|[alan, bloggs, be...|[-0.0010441772533...|\n| 15|      HR|        5|www.downloadmela....|[www.downloadmela...|[www.downloadmela...|[-0.0046009835376...|\n| 16|      HR|        5|anthony brownnhr ...|[anthony, brownnh...|[anthony, brownnh...|[0.01010263937173...|\n| 17|      HR|        5|tnnaylor j onesn1...|[tnnaylor, j, one...|[tnnaylor, j, one...|[-0.0015108942170...|\n| 18|      HR|        5|human resources m...|[human, resources...|[human, resources...|[0.00660504944962...|\n| 19|      HR|        5|edmondxc2xa0brady...|[edmondxc2xa0brad...|[edmondxc2xa0brad...|[-0.0094612471623...|\n| 20|      HR|        5|jonathan burnsn14...|[jonathan, burnsn...|[jonathan, burnsn...|[-0.0038966961106...|\n+---+--------+---------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1544866679229_-849444633","id":"20181215-093759_351419532","dateCreated":"2018-12-15T09:37:59+0000","dateStarted":"2018-12-22T00:25:13+0000","dateFinished":"2018-12-22T00:25:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29904"},{"text":"%md\nAs we can clearly see, we have our text in the vector form(with 300 dimensions) as we wanted it to be. Now let us do the same for Job Descriptions data.\n","user":"anonymous","dateUpdated":"2018-12-21T23:44:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>As we can clearly see, we have our text in the vector form(with 300 dimensions) as we wanted it to be. Now let us do the same for Job Descriptions data.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545435771647_-107646124","id":"20181221-234251_1483310448","dateCreated":"2018-12-21T23:42:51+0000","dateStarted":"2018-12-21T23:44:22+0000","dateFinished":"2018-12-21T23:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29905"},{"text":"%pyspark\n# resume_w2v[['merged_vectors']].show()\n# resume_w2v.toPandas().to_csv('data/res.csv')","user":"anonymous","dateUpdated":"2018-12-19T07:25:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545192538770_1106026273","id":"20181219-040858_1385150804","dateCreated":"2018-12-19T04:08:58+0000","dateStarted":"2018-12-19T07:19:08+0000","dateFinished":"2018-12-19T07:19:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29906"},{"text":"%pyspark\n# load the data and drop currently irrelevant columns\nJDs = sqlContext.read.load('/zeppelin/data/JDs.csv', format='com.databricks.spark.csv', header='true', inferSchema='true')\nJDs = JDs.drop('url', 'headquaters', 'employees', 'founded', 'location')\nJDs.show()\n","user":"anonymous","dateUpdated":"2018-12-22T00:23:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+--------------------+--------------------+--------------------+\n|_c0|             company|            position|            industry|     Job Description|\n+---+--------------------+--------------------+--------------------+--------------------+\n|  1| Visual BI Soluti...|Graduate Intern (...|Information Techn...| Location: Plano,...|\n|  2|          Jobvertise|Digital Marketing...|             Unknown| The Digital Mark...|\n|  3| Santander Consum...|Manager, Pricing ...|             Finance| Summary of Respo...|\n|  4| Federal Reserve ...|Treasury Services...|             Finance| ORGANIZATIONAL S...|\n|  5|              Aviall|Intern, Sales Ana...|Subsidiary or Bus...|   Aviall is the ...|\n|  6| Federal Reserve ...|Human Resources A...|             Finance| ORGANIZATIONAL S...|\n|  7|                Atos|Intern - Business...|             Unknown|  Atos is a leade...|\n|  8|            Atos UK |Intern - Business...|Information Techn...| Job Details Inte...|\n|  9|               70KFT|Digital Marketing...|   Business Services| Job Descriptions...|\n| 10|     Stearns Lending|Data Analyst - In...|             Finance| JOB TITLE Data A...|\n| 11|            Deloitte|Summer Scholar An...|  Accounting & Legal| Passionate about...|\n| 12|        HMS Holdings|Data Scientist In...|         Health Care| Real-world Exper...|\n| 13|            DexMedia|Digital Marketing...|               Media|  Requisition Num...|\n| 14| Brink's, Incorpo...|     Intern (non-IT)|                null| Position Qualifi...|\n| 15|              Aviall|INTERN, Business ...|Subsidiary or Bus...|   Aviall is the ...|\n| 16|      Grant Thornton|Business Risk Ser...|  Accounting & Legal| Please apply to ...|\n| 17|            Deloitte|Information Techn...|  Accounting & Legal| Position summary...|\n| 18|       MedeAnalytics|Data Quality Inte...|Information Techn...|    Company Descr...|\n| 19| American Heart A...|Intern, Research ...|          Non-Profit| Intern, Research...|\n| 20|            Deloitte|Summer Associate ...|  Accounting & Legal| Want to work sid...|\n+---+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545098416402_-189870091","id":"20181218-020016_382572498","dateCreated":"2018-12-18T02:00:16+0000","dateStarted":"2018-12-22T00:25:51+0000","dateFinished":"2018-12-22T00:25:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29907"},{"text":"%pyspark\n# jd_cat = JDs.select('industry').distinct().rdd.zipWithIndex().toDF(schema=['industry', 'id'])\n# resume_w2v = resume_w2v.select('Category').distinct().rdd.zipWithIndex().toDF(schema=['Category', 'id'])\n# resume_w2v.join(jd_cat, resume_w2v.id == jd_cat.id, 'outer').toPandas().to_csv('fields.csv')\n","user":"anonymous","dateUpdated":"2018-12-19T19:55:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545192688294_-1100341748","id":"20181219-041128_1773998486","dateCreated":"2018-12-19T04:11:28+0000","dateStarted":"2018-12-19T05:02:14+0000","dateFinished":"2018-12-19T05:02:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29908"},{"text":"%pyspark\n# convert the job description data into lowercase\nJDs = JDs.withColumn('lower', f.lower(JDs['Job Description']))\nJDs.show()","user":"anonymous","dateUpdated":"2018-12-22T00:23:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+--------------------+--------------------+--------------------+--------------------+\n|_c0|             company|            position|            industry|     Job Description|               lower|\n+---+--------------------+--------------------+--------------------+--------------------+--------------------+\n|  1| Visual BI Soluti...|Graduate Intern (...|Information Techn...| Location: Plano,...| location: plano,...|\n|  2|          Jobvertise|Digital Marketing...|             Unknown| The Digital Mark...| the digital mark...|\n|  3| Santander Consum...|Manager, Pricing ...|             Finance| Summary of Respo...| summary of respo...|\n|  4| Federal Reserve ...|Treasury Services...|             Finance| ORGANIZATIONAL S...| organizational s...|\n|  5|              Aviall|Intern, Sales Ana...|Subsidiary or Bus...|   Aviall is the ...|   aviall is the ...|\n|  6| Federal Reserve ...|Human Resources A...|             Finance| ORGANIZATIONAL S...| organizational s...|\n|  7|                Atos|Intern - Business...|             Unknown|  Atos is a leade...|  atos is a leade...|\n|  8|            Atos UK |Intern - Business...|Information Techn...| Job Details Inte...| job details inte...|\n|  9|               70KFT|Digital Marketing...|   Business Services| Job Descriptions...| job descriptions...|\n| 10|     Stearns Lending|Data Analyst - In...|             Finance| JOB TITLE Data A...| job title data a...|\n| 11|            Deloitte|Summer Scholar An...|  Accounting & Legal| Passionate about...| passionate about...|\n| 12|        HMS Holdings|Data Scientist In...|         Health Care| Real-world Exper...| real-world exper...|\n| 13|            DexMedia|Digital Marketing...|               Media|  Requisition Num...|  requisition num...|\n| 14| Brink's, Incorpo...|     Intern (non-IT)|                null| Position Qualifi...| position qualifi...|\n| 15|              Aviall|INTERN, Business ...|Subsidiary or Bus...|   Aviall is the ...|   aviall is the ...|\n| 16|      Grant Thornton|Business Risk Ser...|  Accounting & Legal| Please apply to ...| please apply to ...|\n| 17|            Deloitte|Information Techn...|  Accounting & Legal| Position summary...| position summary...|\n| 18|       MedeAnalytics|Data Quality Inte...|Information Techn...|    Company Descr...|    company descr...|\n| 19| American Heart A...|Intern, Research ...|          Non-Profit| Intern, Research...| intern, research...|\n| 20|            Deloitte|Summer Associate ...|  Accounting & Legal| Want to work sid...| want to work sid...|\n+---+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545098729102_-1462374265","id":"20181218-020529_2140024542","dateCreated":"2018-12-18T02:05:29+0000","dateStarted":"2018-12-22T00:25:52+0000","dateFinished":"2018-12-22T00:25:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29909"},{"text":"%pyspark\n# lets create a new word to vec model for job descriptions with the same amount of dimensions\nw2v2 = Word2Vec(inputCol=\"stop_removed\", outputCol=\"JDs_w2v\", vectorSize=300, seed=5)\npipeline_2 = Pipeline(stages=[tok, stop, w2v2])\nmodel2 = pipeline_2.fit(JDs)\nJDs_vec = model2.transform(JDs)\nJDs_vec.show()","user":"anonymous","dateUpdated":"2018-12-22T00:23:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|_c0|             company|            position|            industry|     Job Description|               lower|               words|        stop_removed|             JDs_w2v|\n+---+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|  1| Visual BI Soluti...|Graduate Intern (...|Information Techn...| Location: Plano,...| location: plano,...|[, location:, pla...|[, location:, pla...|[0.00725848292124...|\n|  2|          Jobvertise|Digital Marketing...|             Unknown| The Digital Mark...| the digital mark...|[, the, digital, ...|[, digital, marke...|[0.01243905324199...|\n|  3| Santander Consum...|Manager, Pricing ...|             Finance| Summary of Respo...| summary of respo...|[, summary, of, r...|[, summary, respo...|[0.01155161330532...|\n|  4| Federal Reserve ...|Treasury Services...|             Finance| ORGANIZATIONAL S...| organizational s...|[, organizational...|[, organizational...|[0.01206302878870...|\n|  5|              Aviall|Intern, Sales Ana...|Subsidiary or Bus...|   Aviall is the ...|   aviall is the ...|[, , , aviall, is...|[, , , aviall, wo...|[0.01791890182329...|\n|  6| Federal Reserve ...|Human Resources A...|             Finance| ORGANIZATIONAL S...| organizational s...|[, organizational...|[, organizational...|[0.00918273467639...|\n|  7|                Atos|Intern - Business...|             Unknown|  Atos is a leade...|  atos is a leade...|[, , atos, is, a,...|[, , atos, leader...|[0.01483272210376...|\n|  8|            Atos UK |Intern - Business...|Information Techn...| Job Details Inte...| job details inte...|[, job, details, ...|[, job, details, ...|[0.01240374396222...|\n|  9|               70KFT|Digital Marketing...|   Business Services| Job Descriptions...| job descriptions...|[, job, descripti...|[, job, descripti...|[0.00875632726195...|\n| 10|     Stearns Lending|Data Analyst - In...|             Finance| JOB TITLE Data A...| job title data a...|[, job, title dat...|[, job, title dat...|[0.00943058585138...|\n| 11|            Deloitte|Summer Scholar An...|  Accounting & Legal| Passionate about...| passionate about...|[, passionate, ab...|[, passionate, te...|[0.01139746373147...|\n| 12|        HMS Holdings|Data Scientist In...|         Health Care| Real-world Exper...| real-world exper...|[, real-world, ex...|[, real-world, ex...|[0.00806917047354...|\n| 13|            DexMedia|Digital Marketing...|               Media|  Requisition Num...|  requisition num...|[, , requisition,...|[, , requisition,...|[0.01123836729138...|\n| 14| Brink's, Incorpo...|     Intern (non-IT)|                null| Position Qualifi...| position qualifi...|[, position, qual...|[, position, qual...|[0.01580610548751...|\n| 15|              Aviall|INTERN, Business ...|Subsidiary or Bus...|   Aviall is the ...|   aviall is the ...|[, , , aviall, is...|[, , , aviall, wo...|[0.00748155939605...|\n| 16|      Grant Thornton|Business Risk Ser...|  Accounting & Legal| Please apply to ...| please apply to ...|[, please, apply,...|[, please, apply,...|[0.01183358989536...|\n| 17|            Deloitte|Information Techn...|  Accounting & Legal| Position summary...| position summary...|[, position, summ...|[, position, summ...|[0.01246565008992...|\n| 18|       MedeAnalytics|Data Quality Inte...|Information Techn...|    Company Descr...|    company descr...|[, , , , company,...|[, , , , company,...|[0.01206420126476...|\n| 19| American Heart A...|Intern, Research ...|          Non-Profit| Intern, Research...| intern, research...|[, intern,, resea...|[, intern,, resea...|[0.00761399842861...|\n| 20|            Deloitte|Summer Associate ...|  Accounting & Legal| Want to work sid...| want to work sid...|[, want, to, work...|[, want, work, si...|[0.01396156594430...|\n+---+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545098885801_1594465613","id":"20181218-020805_970737583","dateCreated":"2018-12-18T02:08:05+0000","dateStarted":"2018-12-22T00:25:53+0000","dateFinished":"2018-12-22T00:25:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29910"},{"text":"%pyspark\n# renaming the id column to make it consistent with resume data and for eventual joining\nJDs_vec = JDs_vec.withColumnRenamed('_c0', 'ID')\n\n# using pandas to do a certain kind of merger operation not clearly present in spark\nresume_pd = resume_w2v[['ID', 'w2v']].toPandas()\nJD_pd = JDs_vec[['ID', 'JDs_w2v']].toPandas()","user":"anonymous","dateUpdated":"2018-12-22T00:23:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545098728590_-1265382829","id":"20181218-020528_1594411420","dateCreated":"2018-12-18T02:05:28+0000","dateStarted":"2018-12-22T00:25:54+0000","dateFinished":"2018-12-22T00:26:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29911"},{"text":"%pyspark\n# identifying the problematic vectors in the resume data that have the vectors as zero\nresume_pd[resume_pd['w2v']==resume_pd['w2v'][124]]","user":"anonymous","dateUpdated":"2018-12-22T00:23:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"        ID                                                w2v\n124    125  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n182    183  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n312    313  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n481    482  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n525    526  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n697    698  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n736    737  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n1161  1162  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n1195  1196  [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...\n"}]},"apps":[],"jobName":"paragraph_1545436568881_-803910817","id":"20181221-235608_342838772","dateCreated":"2018-12-21T23:56:08+0000","dateStarted":"2018-12-22T00:25:59+0000","dateFinished":"2018-12-22T00:26:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29912"},{"text":"%md\nNow that we have created and cleaned the dataframes for resume and job description, let us create a final one with each resume juxtaposed with every job description.\n","user":"anonymous","dateUpdated":"2018-12-22T00:01:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Now that we have created and cleaned the dataframes for resume and job description, let us create a final one with each resume juxtaposed with every job description.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545436835503_726618663","id":"20181222-000035_1430669367","dateCreated":"2018-12-22T00:00:35+0000","dateStarted":"2018-12-22T00:01:30+0000","dateFinished":"2018-12-22T00:01:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29913"},{"text":"%pyspark\n# removing the ablsolutely zero valued vectors\ntest = resume_pd[resume_pd['w2v']==resume_pd['w2v'][124]]\nresume_pd.drop(resume_pd.index[test.index], inplace=True)\n\n# adding temporary column for merging\nresume_pd['temp']=1\nJD_pd['temp']=1\n\n# merging the two dataframes to get a new one with each resume juxtaposed with every job description\nproduct = pd.merge(JD_pd, resume_pd, on='temp', suffixes=('_orig', '_dest')).drop('temp', axis=1)\n\n# display product dataframe\nproduct","user":"anonymous","dateUpdated":"2018-12-22T00:24:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"        ID_orig                        ...                                                                        w2v\n0             1                        ...                          [-0.00214753184039, 0.022759518379, -0.0098473...\n1             1                        ...                          [0.00186557567443, -0.000739428615064, 0.00584...\n2             1                        ...                          [0.0101026393717, -0.00108860639436, 0.0023814...\n3             1                        ...                          [-0.00417549101705, 0.00715979914509, 0.004765...\n4             1                        ...                          [-0.0597327542205, -0.0267332216431, 0.0213248...\n5             1                        ...                          [-0.00214753184039, 0.022759518379, -0.0098473...\n6             1                        ...                          [-0.00160748337976, 0.00754307509463, 0.007090...\n7             1                        ...                          [0.020078859292, 0.00444162767739, -0.02933115...\n8             1                        ...                          [0.0125401880001, -0.00854350996398, 0.0217087...\n9             1                        ...                          [0.0123277221241, 0.00131520229791, -0.0100416...\n10            1                        ...                          [-0.00642333421471, 0.012881942573, 0.00956288...\n11            1                        ...                          [-0.00603860604072, 0.0141733183093, 0.0085416...\n12            1                        ...                          [-0.00707459913336, 0.00852099430051, 0.007632...\n13            1                        ...                          [-0.00104417725336, 0.00535705065862, 0.011394...\n14            1                        ...                          [-0.00460098353766, 0.00722654741985, 0.005527...\n15            1                        ...                          [0.0101026393717, -0.00108860639436, 0.0023814...\n16            1                        ...                          [-0.00151089421704, 0.00686921497644, 0.011337...\n17            1                        ...                          [0.00660504944963, 0.0197961651417, -0.0120596...\n18            1                        ...                          [-0.00946124716238, -0.0011548287263, -0.00816...\n19            1                        ...                          [-0.00389669611069, 0.010663869904, 0.00569674...\n20            1                        ...                          [-0.00245701038186, 0.00995639641806, 0.007562...\n21            1                        ...                          [-0.00304060524745, 0.00906726822601, 0.005639...\n22            1                        ...                          [0.00123971648859, 0.0126707650779, -0.0053619...\n23            1                        ...                          [0.000659031773789, 0.00831262055828, 0.007925...\n24            1                        ...                          [-0.0123279784457, 0.0289359954186, -0.0241887...\n25            1                        ...                          [-0.027479081326, -0.0145567617733, 0.01026475...\n26            1                        ...                          [0.00115256141483, 0.0247115351182, -0.0113628...\n27            1                        ...                          [-0.00639369960516, 0.012728876399, 0.00978713...\n28            1                        ...                          [0.00531938174458, 0.00159038415204, -0.001918...\n29            1                        ...                          [-0.00639369960516, 0.012728876399, 0.00978713...\n...         ...                        ...                                                                        ...\n189940      157                        ...                          [-0.00487474398966, 0.0200395593151, -0.018522...\n189941      157                        ...                          [0.000654128907869, 0.00688367032756, -0.00606...\n189942      157                        ...                          [-0.00141259290401, -0.000393969324787, -0.001...\n189943      157                        ...                          [0.00774911056761, 0.0052785867068, -0.0132559...\n189944      157                        ...                          [-0.000197949805226, 0.0207391596493, -0.02100...\n189945      157                        ...                          [0.0150857653676, -0.017391346408, 0.031321061...\n189946      157                        ...                          [-0.000256715461995, 0.0199578330592, -0.03963...\n189947      157                        ...                          [0.000895392556297, 0.0113316890126, -0.009606...\n189948      157                        ...                          [-0.00758690297103, 0.014866457352, -0.0036961...\n189949      157                        ...                          [0.00308569792486, 0.012767540934, -0.01396565...\n189950      157                        ...                          [0.00486111921905, 0.00617067447965, -0.009822...\n189951      157                        ...                          [0.0141952466713, -0.0192543490888, 0.00607736...\n189952      157                        ...                          [0.00347075159164, 0.0085208136379, -0.0064242...\n189953      157                        ...                          [0.049733877352, -0.102894531042, 0.1121399963...\n189954      157                        ...                          [-0.00230818723656, 0.00733214941569, -0.00717...\n189955      157                        ...                          [0.0124677595814, -0.0414235961097, 0.05294621...\n189956      157                        ...                          [0.00256810109548, 0.0108471240876, -0.0088970...\n189957      157                        ...                          [-0.0017338795697, 0.00590313188862, 0.0075618...\n189958      157                        ...                          [0.00350370176765, 0.00178809918361, 0.0104847...\n189959      157                        ...                          [0.00697572179497, -0.0112810370138, 0.0049116...\n189960      157                        ...                          [-0.000296798019419, 0.006080447554, 0.0084839...\n189961      157                        ...                          [0.00525430924806, 0.00041181814229, 0.0095880...\n189962      157                        ...                          [-0.00347695829091, 0.0119755030874, -0.019973...\n189963      157                        ...                          [-0.000490890281649, 0.0185365434784, -0.01931...\n189964      157                        ...                          [0.000314562884806, 0.00386205660664, 0.011721...\n189965      157                        ...                          [0.0133590727611, -0.00955757875503, -0.011618...\n189966      157                        ...                          [-0.000667393438434, 0.00486016339792, 0.01209...\n189967      157                        ...                          [0.00101431471061, 0.0264263653789, -0.0201872...\n189968      157                        ...                          [0.00710870528268, 0.0196967099541, -0.0242417...\n189969      157                        ...                          [0.00984464315949, -0.000650824955885, -0.0062...\n\n[189970 rows x 4 columns]\n"}]},"apps":[],"jobName":"paragraph_1545202580739_1852621606","id":"20181219-065620_300932962","dateCreated":"2018-12-19T06:56:20+0000","dateStarted":"2018-12-22T00:26:02+0000","dateFinished":"2018-12-22T00:26:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29914"},{"text":"%md\nNow that we have created a dataframe containing each and every resume/job description combination possible, we'll apply cosine similarity function to get the similarity value for each of those combination.","user":"anonymous","dateUpdated":"2018-12-22T00:04:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Now that we have created a dataframe containing each and every resume/job description combination possible, we&rsquo;ll apply cosine similarity function to get the similarity value for each of those combination.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545436918220_-372300817","id":"20181222-000158_1479981350","dateCreated":"2018-12-22T00:01:58+0000","dateStarted":"2018-12-22T00:04:08+0000","dateFinished":"2018-12-22T00:04:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29915"},{"text":"%pyspark\nfrom scipy.spatial.distance import cosine","user":"anonymous","dateUpdated":"2018-12-22T00:24:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545102538636_-177490848","id":"20181218-030858_1441045165","dateCreated":"2018-12-18T03:08:58+0000","dateStarted":"2018-12-22T00:26:02+0000","dateFinished":"2018-12-22T00:26:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29916"},{"text":"%pyspark\n# function that returns the value for similarity\ndef cosine_sim(x):\n    return 1-(cosine(x['JDs_w2v'], x['w2v']))\n    \n# add column that stores the similarities\nproduct['sim'] = product.apply(cosine_sim, axis=1)","user":"anonymous","dateUpdated":"2018-12-22T00:24:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1545105746291_-715945028","id":"20181218-040226_539193212","dateCreated":"2018-12-18T04:02:26+0000","dateStarted":"2018-12-22T00:26:03+0000","dateFinished":"2018-12-22T00:26:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29917"},{"text":"%pyspark\n# lets see some statistics of this new column\nproduct['sim'].describe()","user":"anonymous","dateUpdated":"2018-12-22T00:24:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"count    189970.000000\nmean          0.261390\nstd           0.249389\nmin          -0.615107\n25%           0.094929\n50%           0.296429\n75%           0.455701\nmax           0.779475\nName: sim, dtype: float64\n"}]},"apps":[],"jobName":"paragraph_1545437128620_1424013532","id":"20181222-000528_1770052471","dateCreated":"2018-12-22T00:05:28+0000","dateStarted":"2018-12-22T00:26:03+0000","dateFinished":"2018-12-22T00:26:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29918"},{"text":"%md\nAs we can see that we have obtained some decent results. Let us now take up a chunk (combinations with similarities greater than 0.5) back to spark to apply some aggregation.\n","user":"anonymous","dateUpdated":"2018-12-22T00:08:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>As we can see that we have obtained some decent results. Let us now take up a chunk (combinations with similarities greater than 0.5) back to spark to apply some aggregation.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545437213397_872542476","id":"20181222-000653_1103652018","dateCreated":"2018-12-22T00:06:53+0000","dateStarted":"2018-12-22T00:08:09+0000","dateFinished":"2018-12-22T00:08:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29919"},{"text":"%pyspark\n# take only those records with similarity over 50%\nresults = sqlContext.createDataFrame(product[product['sim']>.50])\nresults.show()","user":"anonymous","dateUpdated":"2018-12-22T00:26:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+-------+--------------------+------------------+\n|ID_orig|             JDs_w2v|ID_dest|                 w2v|               sim|\n+-------+--------------------+-------+--------------------+------------------+\n|      1|[0.00725848292124...|      1|[-0.0021475318403...|0.5774336882776231|\n|      1|[0.00725848292124...|      4|[-0.0041754910170...|0.5653909351001385|\n|      1|[0.00725848292124...|      6|[-0.0021475318403...|0.5774336882776231|\n|      1|[0.00725848292124...|      7|[-0.0016074833797...|0.5339755593846295|\n|      1|[0.00725848292124...|     11|[-0.0064233342147...|0.5735886296851311|\n|      1|[0.00725848292124...|     12|[-0.0060386060407...|0.5535240719288096|\n|      1|[0.00725848292124...|     13|[-0.0070745991333...|0.5501327026866907|\n|      1|[0.00725848292124...|     14|[-0.0010441772533...|0.5106281956774282|\n|      1|[0.00725848292124...|     15|[-0.0046009835376...|0.5675861047145482|\n|      1|[0.00725848292124...|     17|[-0.0015108942170...|0.5179066803182109|\n|      1|[0.00725848292124...|     18|[0.00660504944962...|0.5477566161614148|\n|      1|[0.00725848292124...|     20|[-0.0038966961106...|0.5983862950629444|\n|      1|[0.00725848292124...|     21|[-0.0024570103818...|0.5337607826553107|\n|      1|[0.00725848292124...|     22|[-0.0030406052474...|0.5925500803055717|\n|      1|[0.00725848292124...|     23|[0.00123971648858...|0.5549419366116193|\n|      1|[0.00725848292124...|     24|[6.59031773788697...|0.5083950490687502|\n|      1|[0.00725848292124...|     28|[-0.0063936996051...|0.5749630669532122|\n|      1|[0.00725848292124...|     30|[-0.0063936996051...|0.5749630669532122|\n|      1|[0.00725848292124...|     31|[-0.0061647303165...|0.6145749821320035|\n|      1|[0.00725848292124...|     32|[-2.5473612180656...|0.5268285180130202|\n+-------+--------------------+-------+--------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545210904571_-482499976","id":"20181219-091504_1656289265","dateCreated":"2018-12-19T09:15:04+0000","dateStarted":"2018-12-22T00:26:36+0000","dateFinished":"2018-12-22T00:27:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29920"},{"text":"%md\nLet us now find out the top 10 resumes for each kind of job description.\n","user":"anonymous","dateUpdated":"2018-12-22T00:13:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Let us now find out the top 10 resumes for each kind of job description.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545437563372_1734874199","id":"20181222-001243_355352100","dateCreated":"2018-12-22T00:12:43+0000","dateStarted":"2018-12-22T00:13:35+0000","dateFinished":"2018-12-22T00:13:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29921"},{"text":"%pyspark\nfrom pyspark.sql.window import Window\n\n# let us use window function to pick the top 10 resumes for each job description\nwindow = Window.partitionBy(results['ID_orig']).orderBy(results['sim'].desc())\ntop_10 = results.select('*', f.rank().over(window).alias('rank')).filter(f.col('rank') <= 10).orderBy('ID_orig', 'rank')\ntop_10.show()","user":"anonymous","dateUpdated":"2018-12-22T00:27:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+-------+--------------------+------------------+----+\n|ID_orig|             JDs_w2v|ID_dest|                 w2v|               sim|rank|\n+-------+--------------------+-------+--------------------+------------------+----+\n|      1|[0.00725848292124...|    178|[-0.0135989293092...|0.6951450583024887|   1|\n|      1|[0.00725848292124...|    196|[-0.0104139854166...|0.6903502787035369|   2|\n|      1|[0.00725848292124...|    945|[-0.0088473186857...|0.6854567189863672|   3|\n|      1|[0.00725848292124...|    207|[-0.0088473186857...|0.6854567189863672|   3|\n|      1|[0.00725848292124...|     92|[-0.0088070048637...|0.6840811300741338|   5|\n|      1|[0.00725848292124...|     83|[-0.0084059573415...|0.6829859713901099|   6|\n|      1|[0.00725848292124...|    193|[-0.0151470582156...|0.6829484044891191|   7|\n|      1|[0.00725848292124...|     74|[-0.0101796812169...|0.6824634856288271|   8|\n|      1|[0.00725848292124...|    218|[-0.0057157252508...|0.6816553272209106|   9|\n|      1|[0.00725848292124...|    205|[-0.0195663023762...| 0.678088288462803|  10|\n|      2|[0.01243905324199...|     54|[-0.0024050289282...|0.6216051256236507|   1|\n|      2|[0.01243905324199...|     56|[-0.0036890892645...|0.6102919731272777|   2|\n|      2|[0.01243905324199...|    178|[-0.0135989293092...|0.6102634094478301|   3|\n|      2|[0.01243905324199...|    238|[-0.0060157534136...| 0.609482099964237|   4|\n|      2|[0.01243905324199...|    220|[-0.0073744842768...|0.6092631186006007|   5|\n|      2|[0.01243905324199...|    196|[-0.0104139854166...|0.6075223229487908|   6|\n|      2|[0.01243905324199...|     83|[-0.0084059573415...|0.6057055153667433|   7|\n|      2|[0.01243905324199...|     44|[-0.0087379893799...|0.6034328361195033|   8|\n|      2|[0.01243905324199...|     92|[-0.0088070048637...|0.6023087786226567|   9|\n|      2|[0.01243905324199...|    189|[-0.0037560731463...|0.6008573676827084|  10|\n+-------+--------------------+-------+--------------------+------------------+----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1545218158688_1784847874","id":"20181219-111558_795628960","dateCreated":"2018-12-19T11:15:58+0000","dateStarted":"2018-12-22T00:27:24+0000","dateFinished":"2018-12-22T00:28:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29922"},{"text":"%md\nThe following is just a quality check of the word2vec model applied on resumes. It shows how the model finds synonyms of words with respect to the corpus it creates with the data it fits.","user":"anonymous","dateUpdated":"2018-12-22T01:47:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The following is just a quality check of the word2vec model applied on resumes. It shows how the model finds synonyms of words with respect to the corpus it creates with the data it fits.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1545442836825_948783458","id":"20181222-014036_846694275","dateCreated":"2018-12-22T01:40:36+0000","dateStarted":"2018-12-22T01:47:36+0000","dateFinished":"2018-12-22T01:47:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29923"},{"text":"%pyspark\ntok_3 = Tokenizer(inputCol=\"lower\", outputCol=\"words\")\nstop_3 = StopWordsRemover(inputCol=\"words\", outputCol=\"stop_removed\")\nw2v_3= Word2Vec(inputCol=\"stop_removed\", outputCol=\"w2v\", vectorSize=300, seed=5)\none = tok_3.transform(data_res)\ntwo = stop_3.transform(one)\nthree = w2v_3.fit(two)","user":"anonymous","dateUpdated":"2018-12-22T01:46:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1544929174988_-1524815586","id":"20181216-025934_922152959","dateCreated":"2018-12-16T02:59:34+0000","dateStarted":"2018-12-22T01:46:03+0000","dateFinished":"2018-12-22T01:46:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29924"},{"text":"%pyspark\n# finding synonyms for the word 'sql'\nsynonyms = three.findSynonyms('sql', 5)\nsynonyms.show()","user":"anonymous","dateUpdated":"2018-12-22T01:47:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+------------------+\n|        word|        similarity|\n+------------+------------------+\n|      oracle|0.9589198933241962|\n|      server|0.9442997826267602|\n|      tools,|0.9371090950113722|\n|programming,|0.9193727022736173|\n|      visual|0.9128314854681193|\n+------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1545251803638_48510254","id":"20181219-203643_563424569","dateCreated":"2018-12-19T20:36:43+0000","dateStarted":"2018-12-22T01:47:16+0000","dateFinished":"2018-12-22T01:47:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:29925"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-12-22T00:50:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1545439809388_1882419086","id":"20181222-005009_147393103","dateCreated":"2018-12-22T00:50:09+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:29926"},{"text":"","user":"anonymous","dateUpdated":"2018-12-22T01:12:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544750867573_-772086345","id":"20181214-012747_2070274849","dateCreated":"2018-12-14T01:27:47+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:29927"}],"name":"word_embedding_implementation","id":"2DYFHBXKC","angularObjects":{"2DY7J3NMZ:shared_process":[],"2DWJF5MVU:shared_process":[],"2DZNEJSM7:shared_process":[],"2DY7GMTRS:shared_process":[],"2DW3PM6CK:shared_process":[],"2DY87GFGQ:shared_process":[],"2DW8ZKDTU:shared_process":[],"2DZ4SMH2C:shared_process":[],"2DYT8PAQP:shared_process":[],"2DXZQ2GDX:shared_process":[],"2DW26S2ME:shared_process":[],"2DXS74HDA:shared_process":[],"2DXZ6S7T4:shared_process":[],"2DY4XN6NT:shared_process":[],"2DXXY3ZHB:shared_process":[],"2DZBUK8HA:shared_process":[],"2DWN1576W:shared_process":[],"2DXCWHJ6N:shared_process":[],"2DXZK5W6F:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}